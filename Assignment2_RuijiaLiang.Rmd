---
title: "Assignment2_RuijiaLiang"
author: "Ruijia Liang u7457322"
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2:
    code_folding: show
    number_sections: no
    toc: yes
    toc_depth: 6
    toc_float: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r libraries, echo=FALSE, include=TRUE, message=FALSE, warning=FALSE}
library(pacman)
p_load(bookdown, devtools, tidyverse, ggforce, GGally, flextable, latex2exp, png, magick, metafor, MASS, emmeans, R.rsp, orchaRd, pander, mathjaxr, equatags, vembedr)
```

# Preparation before analysing

```{r load the data, echo = FALSE, results = 'hide', warning=FALSE, error=FALSE, message=FALSE}
data <- read_csv("./data/OA_activitydat_20190302_BIOL3207.csv")
```


```{r remove NA}
data <- data[complete.cases(data),]
```


```{r convert into factors}
data$species <- factor(data$species)
data$treatment <- factor(data$treatment)
```


# Generate the summary statistics 


```{r get N and sd and means}
get_statistics <- function(species_name){
  t_species_data <- data %>% filter(species==species_name,treatment=="CO2")
  c_species_data <- data %>% filter(species==species_name,treatment=="control")

  species_statistics <- data.frame(species = character(), treatment = character(), N = numeric(), mean = numeric(), sd = numeric())
  
  species_statistics[1,1] <- species_name
  species_statistics[1,2] <- "CO2"
  species_statistics[1,3] <- length(t_species_data$activity)
  species_statistics[1,4] <- mean(t_species_data$activity)
  species_statistics[1,5] <- sd(t_species_data$activity)
  
  species_statistics[2,1] <- species_name
  species_statistics[2,2] <- "control"
  species_statistics[2,3] <- length(c_species_data$activity)
  species_statistics[2,4] <- mean(c_species_data$activity)
  species_statistics[2,5] <- sd(c_species_data$activity)
  
  return(species_statistics)
}
```


```{r make a summary table}
summary_table <- rbind(get_statistics("acantho"),get_statistics("ambon"),get_statistics("chromis"),get_statistics("humbug"),get_statistics("lemon"),get_statistics("whitedams"))
flextable(summary_table) %>% add_header_lines(.,values = "Summary of data")
```














